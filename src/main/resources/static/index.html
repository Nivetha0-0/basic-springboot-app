<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Posts</title>
</head>
<body>
<h1>Job Posts</h1>

<!-- Add Post -->
<section>
<h2>Add Post</h2>
<input type="text" id="profile" placeholder="Profile">
<input type="text" id="desc" placeholder="Description">
<input type="number" id="exp" placeholder="Experience">
<input type="text" id="techs" placeholder="Techs (comma separated)">
<button onclick="addPost()">Add Post</button>
<pre id="addPostResponse"></pre>
</section>

<hr>

<!-- Get All Posts -->
<section>
<h2>All Posts</h2>
<button onclick="getAllPosts()">Fetch Posts</button>
<pre id="allPostsResponse"></pre>
</section>

<hr>

<!-- Search Posts -->
<section>
<h2>Search Posts</h2>
<input type="text" id="searchText" placeholder="Enter text">
<button onclick="searchPosts()">Search</button>
<pre id="searchPostsResponse"></pre>
</section>

<script>
const baseUrl = 'https://basic-springboot-app.onrender.com';

// POST /addingPost
async function addPost() {
    const post = {
        profile: document.getElementById('profile').value,
        desc: document.getElementById('desc').value,
        exp: parseInt(document.getElementById('exp').value),
        techs: document.getElementById('techs').value.split(',').map(s => s.trim())
    };

    try {
        const res = await fetch(`${baseUrl}/addingPost`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(post)
        });
        const data = await res.json();
        document.getElementById('addPostResponse').textContent = JSON.stringify(data, null, 2);
    } catch (err) {
        document.getElementById('addPostResponse').textContent = 'Error: ' + err;
    }
}

// GET /posts
async function getAllPosts() {
    try {
        const res = await fetch(`${baseUrl}/posts`);
        const data = await res.json();
        document.getElementById('allPostsResponse').textContent = JSON.stringify(data, null, 2);
    } catch (err) {
        document.getElementById('allPostsResponse').textContent = 'Error: ' + err;
    }
}

// GET /posts/{text}
async function searchPosts() {
    const text = document.getElementById('searchText').value;
    try {
        const res = await fetch(`${baseUrl}/posts/${encodeURIComponent(text)}`);
        const data = await res.json();
        document.getElementById('searchPostsResponse').textContent = JSON.stringify(data, null, 2);
    } catch (err) {
        document.getElementById('searchPostsResponse').textContent = 'Error: ' + err;
    }
}
</script>
</body>
</html>
